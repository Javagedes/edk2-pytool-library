
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Project Mu Documentation">
      
      
        <link rel="canonical" href="https://matthewc.dev/edk2-pytool-library/master/edk2toollib/utility_functions/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Utility functions - EDK2 Pytool Library</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/version-select.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-edk2toollibutility_functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://matthewc.dev/edk2-pytool-library/master/" title="EDK2 Pytool Library" class="md-header-nav__button md-logo" aria-label="EDK2 Pytool Library">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            EDK2 Pytool Library
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Utility functions
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/matthewfcarlson/edk2-pytool-library/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://matthewc.dev/edk2-pytool-library/master/" title="EDK2 Pytool Library" class="md-nav__button md-logo" aria-label="EDK2 Pytool Library">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    EDK2 Pytool Library
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/matthewfcarlson/edk2-pytool-library/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../developing/" class="md-nav__link">
      Developing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../publishing/" class="md-nav__link">
      Publishing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../using/" class="md-nav__link">
      Using
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Features
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Features" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/logging.ansi_handler/" class="md-nav__link">
      Logging.ansi handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/utility_functions.GetHostInfo/" class="md-nav__link">
      Utility functions.get host info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../features/windows_firmware_policy/" class="md-nav__link">
      Windows firmware policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../bin/" class="md-nav__link">
      Bin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gitignore_parser/" class="md-nav__link">
      Gitignore parser
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Utility functions
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Utility functions
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#catalogsignwithsigntool" class="md-nav__link">
    CatalogSignWithSignTool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detachedsignwithsigntool" class="md-nav__link">
    DetachedSignWithSignTool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    Enum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gethostinfo" class="md-nav__link">
    GetHostInfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printbytelist" class="md-nav__link">
    PrintByteList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runcmd" class="md-nav__link">
    RunCmd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runpythonscript" class="md-nav__link">
    RunPythonScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_module_by_file_name" class="md-nav__link">
    import_module_by_file_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_version" class="md-nav__link">
    is_valid_version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locate_class_in_module" class="md-nav__link">
    locate_class_in_module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reader" class="md-nav__link">
    reader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing" class="md-nav__link">
    timing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version_compare" class="md-nav__link">
    version_compare
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagatingthread" class="md-nav__link">
    PropagatingThread
  </a>
  
    <nav class="md-nav" aria-label="PropagatingThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getname" class="md-nav__link">
    getName
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isalive" class="md-nav__link">
    isAlive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdaemon" class="md-nav__link">
    isDaemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_alive" class="md-nav__link">
    is_alive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setdaemon" class="md-nav__link">
    setDaemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setname" class="md-nav__link">
    setName
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Acpi
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Acpi" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        <span class="md-nav__icon md-icon"></span>
        Acpi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../acpi/dmar_parser/" class="md-nav__link">
      Dmar parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../acpi/ivrs_parser/" class="md-nav__link">
      Ivrs parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Log
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Log" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        <span class="md-nav__icon md-icon"></span>
        Log
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../log/ansi_handler/" class="md-nav__link">
      Ansi handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../log/file_handler/" class="md-nav__link">
      File handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../log/junit_report_format/" class="md-nav__link">
      Junit report format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../log/markdown_handler/" class="md-nav__link">
      Markdown handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../log/string_handler/" class="md-nav__link">
      String handler
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      Tpm
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tpm" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        <span class="md-nav__icon md-icon"></span>
        Tpm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tpm/tpm2_defs/" class="md-nav__link">
      Tpm2 defs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tpm/tpm2_policy_calc/" class="md-nav__link">
      Tpm2 policy calc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tpm/tpm2_simulator/" class="md-nav__link">
      Tpm2 simulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tpm/tpm2_stream/" class="md-nav__link">
      Tpm2 stream
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Uefi
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Uefi" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        <span class="md-nav__icon md-icon"></span>
        Uefi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/authenticated_variables_structure_support/" class="md-nav__link">
      Authenticated variables structure support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/bmp_object/" class="md-nav__link">
      Bmp object
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/fmp_auth_header/" class="md-nav__link">
      Fmp auth header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/fmp_capsule_header/" class="md-nav__link">
      Fmp capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/pi_firmware_file/" class="md-nav__link">
      Pi firmware file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/pi_firmware_volume/" class="md-nav__link">
      Pi firmware volume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/status_codes/" class="md-nav__link">
      Status codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/uefi_capsule_header/" class="md-nav__link">
      Uefi capsule header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/uefi_multi_phase/" class="md-nav__link">
      Uefi multi phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/wincert/" class="md-nav__link">
      Wincert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7-11" type="checkbox" id="nav-6-7-11">
    
    <label class="md-nav__link" for="nav-6-7-11">
      Edk2
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Edk2" data-md-level="3">
      <label class="md-nav__title" for="nav-6-7-11">
        <span class="md-nav__icon md-icon"></span>
        Edk2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/fmp_payload_header/" class="md-nav__link">
      Fmp payload header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/ftw_working_block_format/" class="md-nav__link">
      Ftw working block format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/guid_list/" class="md-nav__link">
      Guid list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/path_utilities/" class="md-nav__link">
      Path utilities
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/variablestore_manulipulations/" class="md-nav__link">
      Variablestore manulipulations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/variable_format/" class="md-nav__link">
      Variable format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7-11-7" type="checkbox" id="nav-6-7-11-7">
    
    <label class="md-nav__link" for="nav-6-7-11-7">
      Build objects
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Build objects" data-md-level="4">
      <label class="md-nav__title" for="nav-6-7-11-7">
        <span class="md-nav__icon md-icon"></span>
        Build objects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/build_objects/dsc/" class="md-nav__link">
      Dsc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/build_objects/dsc_translator/" class="md-nav__link">
      Dsc translator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/build_objects/readme/" class="md-nav__link">
      Readme
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7-11-8" type="checkbox" id="nav-6-7-11-8">
    
    <label class="md-nav__link" for="nav-6-7-11-8">
      Parsers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Parsers" data-md-level="4">
      <label class="md-nav__title" for="nav-6-7-11-8">
        <span class="md-nav__icon md-icon"></span>
        Parsers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/base_parser/" class="md-nav__link">
      Base parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/buildreport_parser/" class="md-nav__link">
      Buildreport parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/dec_parser/" class="md-nav__link">
      Dec parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/dsc_parser/" class="md-nav__link">
      Dsc parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/fdf_parser/" class="md-nav__link">
      Fdf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/guid_parser/" class="md-nav__link">
      Guid parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/inf_parser/" class="md-nav__link">
      Inf parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/override_parser/" class="md-nav__link">
      Override parser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../uefi/edk2/parsers/targettxt_parser/" class="md-nav__link">
      Targettxt parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-8" type="checkbox" id="nav-6-8">
    
    <label class="md-nav__link" for="nav-6-8">
      Windows
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Windows" data-md-level="2">
      <label class="md-nav__title" for="nav-6-8">
        <span class="md-nav__icon md-icon"></span>
        Windows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/locate_tools/" class="md-nav__link">
      Locate tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-8-2" type="checkbox" id="nav-6-8-2">
    
    <label class="md-nav__link" for="nav-6-8-2">
      Capsule
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Capsule" data-md-level="3">
      <label class="md-nav__title" for="nav-6-8-2">
        <span class="md-nav__icon md-icon"></span>
        Capsule
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/capsule/cat_generator/" class="md-nav__link">
      Cat generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/capsule/inf_generator/" class="md-nav__link">
      Inf generator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-8-3" type="checkbox" id="nav-6-8-3">
    
    <label class="md-nav__link" for="nav-6-8-3">
      Policy
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Policy" data-md-level="3">
      <label class="md-nav__title" for="nav-6-8-3">
        <span class="md-nav__icon md-icon"></span>
        Policy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../windows/policy/firmware_policy/" class="md-nav__link">
      Firmware policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#catalogsignwithsigntool" class="md-nav__link">
    CatalogSignWithSignTool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detachedsignwithsigntool" class="md-nav__link">
    DetachedSignWithSignTool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    Enum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gethostinfo" class="md-nav__link">
    GetHostInfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printbytelist" class="md-nav__link">
    PrintByteList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runcmd" class="md-nav__link">
    RunCmd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runpythonscript" class="md-nav__link">
    RunPythonScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_module_by_file_name" class="md-nav__link">
    import_module_by_file_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_valid_version" class="md-nav__link">
    is_valid_version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#locate_class_in_module" class="md-nav__link">
    locate_class_in_module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reader" class="md-nav__link">
    reader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing" class="md-nav__link">
    timing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version_compare" class="md-nav__link">
    version_compare
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#propagatingthread" class="md-nav__link">
    PropagatingThread
  </a>
  
    <nav class="md-nav" aria-label="PropagatingThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getname" class="md-nav__link">
    getName
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isalive" class="md-nav__link">
    isAlive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdaemon" class="md-nav__link">
    isDaemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_alive" class="md-nav__link">
    is_alive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setdaemon" class="md-nav__link">
    setDaemon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setname" class="md-nav__link">
    setName
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/matthewfcarlson/edk2-pytool-library/edit/master/docs/edk2toollib/utility_functions.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="module-edk2toollibutility_functions">Module edk2toollib.utility_functions</h1>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="c1">##</span>

<span class="c1"># Utility Functions to support re-use in python scripts.</span>

<span class="c1"># Includes functions for running external commands, etc</span>

<span class="c1">#</span>

<span class="c1"># Copyright (c) Microsoft Corporation</span>

<span class="c1">#</span>

<span class="c1"># SPDX-License-Identifier: BSD-2-Clause-Patent</span>

<span class="c1">##</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">shutil</span>

<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">inspect</span>

<span class="kn">import</span> <span class="nn">platform</span>

<span class="kn">import</span> <span class="nn">importlib</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span> <span class="k">as</span> <span class="n">StdEnum</span>

<span class="k">def</span> <span class="nf">Enum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">item</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

            <span class="n">items</span> <span class="o">=</span> <span class="n">item</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>

            <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">args</span>

    <span class="n">calling_frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">calling_mod</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">calling_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">calling_func</span> <span class="o">=</span> <span class="n">calling_frame</span><span class="o">.</span><span class="n">function</span>

    <span class="n">calling_line</span> <span class="o">=</span> <span class="n">calling_frame</span><span class="o">.</span><span class="n">lineno</span>

    <span class="n">enum_name</span> <span class="o">=</span> <span class="n">calling_func</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">calling_line</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Enum is deprecated! Please fix it in {calling_mod}:{calling_func}&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">StdEnum</span><span class="p">(</span><span class="n">enum_name</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="n">calling_mod</span><span class="p">)</span>

<span class="c1">####</span>

<span class="c1"># Class to support running commands from the shell in a python environment.</span>

<span class="c1"># Don&#39;t use directly.</span>

<span class="c1">#</span>

<span class="c1"># PropagatingThread copied from sample here:</span>

<span class="c1"># https://stackoverflow.com/questions/2829329/catch-a-threads-exception-in-the-caller-thread-in-python</span>

<span class="c1">####</span>

<span class="k">class</span> <span class="nc">PropagatingThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exc</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_Thread__target&#39;</span><span class="p">):</span>

                <span class="c1"># Thread uses name mangling prior to Python 3.</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Thread__target</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_Thread__args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_Thread__kwargs</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">exc</span> <span class="o">=</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PropagatingThread</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exc</span><span class="p">:</span>

            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">exc</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ret</span>

<span class="c1">####</span>

<span class="c1"># Helper functions for running commands from the shell in python environment</span>

<span class="c1"># Don&#39;t use directly</span>

<span class="c1">#</span>

<span class="c1"># process output stream and write to log.</span>

<span class="c1"># part of the threading pattern.</span>

<span class="c1">#</span>

<span class="c1">#  http://stackoverflow.com/questions/19423008/logged-subprocess-communicate</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">reader</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">outstream</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">):</span>

    <span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># open file if caller provided path</span>

    <span class="k">if</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>

            <span class="k">break</span>

        <span class="k">if</span><span class="p">(</span><span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>

            <span class="c1"># write to file if caller provided file</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">outstream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>

            <span class="c1"># write to stream object if caller provided object</span>

            <span class="n">outstream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

    <span class="n">stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span><span class="p">(</span><span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>

        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">####</span>

<span class="c1"># Returns a namedtuple containing information about host machine.</span>

<span class="c1">#</span>

<span class="c1"># @return namedtuple Host(os=OS Type, arch=System Architecture, bit=Highest Order Bit)</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">GetHostInfo</span><span class="p">():</span>

    <span class="n">Host</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="s1">&#39;os arch bit&#39;</span><span class="p">)</span>

    <span class="n">host_info</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">uname</span><span class="p">()</span>

    <span class="n">os</span> <span class="o">=</span> <span class="n">host_info</span><span class="o">.</span><span class="n">system</span>

    <span class="n">processor_info</span> <span class="o">=</span> <span class="n">host_info</span><span class="o">.</span><span class="n">machine</span>

    <span class="n">arch</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">bit</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;x86&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;AMD&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;INTEL&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="o">.</span><span class="n">upper</span><span class="p">()):</span>

        <span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;x86&quot;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="s2">&quot;ARM&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;AARCH&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="o">.</span><span class="n">upper</span><span class="p">()):</span>

        <span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;ARM&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;32&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="p">:</span>

        <span class="n">bit</span> <span class="o">=</span> <span class="s2">&quot;32&quot;</span>

    <span class="k">elif</span> <span class="s2">&quot;64&quot;</span> <span class="ow">in</span> <span class="n">processor_info</span><span class="p">:</span>

        <span class="n">bit</span> <span class="o">=</span> <span class="s2">&quot;64&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">arch</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">bit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>

        <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span><span class="s2">&quot;Host info could not be parsed: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">host_info</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">Host</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="n">os</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">arch</span><span class="p">,</span> <span class="n">bit</span><span class="o">=</span><span class="n">bit</span><span class="p">)</span>

<span class="c1">####</span>

<span class="c1"># This is a mixing to do timing on a function. Use it like this:</span>

<span class="c1">#</span>

<span class="c1"># @timing</span>

<span class="c1"># def function_i_want_to_time():</span>

<span class="c1">#   ...</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">timing</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="n">time2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;{:s} function took {:.3f} ms&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">(</span><span class="n">time2</span> <span class="o">-</span> <span class="n">time1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">return</span> <span class="n">wrap</span>

<span class="c1">####</span>

<span class="c1"># Run a shell command and print the output to the log file</span>

<span class="c1"># This is the public function that should be used to run commands from the shell in python environment</span>

<span class="c1"># @param cmd - command being run, either quoted or not quoted</span>

<span class="c1"># @param parameters - parameters string taken as is</span>

<span class="c1"># @param capture - boolean to determine if caller wants the output captured in any format.</span>

<span class="c1"># @param workingdir - path to set to the working directory before running the command.</span>

<span class="c1"># @param outfile - capture output to file of given path.</span>

<span class="c1"># @param outstream - capture output to a stream.</span>

<span class="c1"># @param environ - shell environment variables dictionary that replaces the one inherited from the</span>

<span class="c1">#                  current process.</span>

<span class="c1"># @param logging_level - log level to log output at.  Default is INFO</span>

<span class="c1"># @param raise_exception_on_nonzero - Setting to true causes exception to be raised if the cmd</span>

<span class="c1">#                                     return code is not zero.</span>

<span class="c1">#</span>

<span class="c1"># @return returncode of called cmd</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">RunCmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">outstream</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>

           <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">cmd</span><span class="p">:</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">cmd</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">parameters</span>

    <span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;Cmd to run is: &quot;</span> <span class="o">+</span> <span class="n">cmd</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;--------------Cmd Output Starting---------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">workingdir</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">environ</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">capture</span><span class="p">):</span>

        <span class="n">thread</span> <span class="o">=</span> <span class="n">PropagatingThread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">outstream</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">logging_level</span><span class="p">))</span>

        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="n">c</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">c</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="n">endtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span>

    <span class="n">endtime_str</span> <span class="o">=</span> <span class="s2">&quot;{0[0]:02}:{0[1]:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">divmod</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>

    <span class="n">returncode_str</span> <span class="o">=</span> <span class="s2">&quot;{0:#010x}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">returncode</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;--------------Cmd Output Finished---------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;--------- Running Time (mm:ss): &quot;</span> <span class="o">+</span> <span class="n">endtime_str</span> <span class="o">+</span> <span class="s2">&quot; ----------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;----------- Return Code: &quot;</span> <span class="o">+</span> <span class="n">returncode_str</span> <span class="o">+</span> <span class="s2">&quot; ------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="s2">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">raise_exception_on_nonzero</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;{0} failed with Return Code: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">returncode_str</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">returncode</span>

<span class="c1">####</span>

<span class="c1"># Run a python script and print the output to the log file</span>

<span class="c1"># This is the public function that should be used to execute python scripts from the shell in python environment.</span>

<span class="c1"># The python script will be located using the path as if it was an executable.</span>

<span class="c1">#</span>

<span class="c1"># @param cmd - cmd string to run including parameters</span>

<span class="c1"># @param capture - boolean to determine if caller wants the output captured in any format.</span>

<span class="c1"># @param workingdir - path to set to the working directory before running the command.</span>

<span class="c1"># @param outfile - capture output to file of given path.</span>

<span class="c1"># @param outstream - capture output to a stream.</span>

<span class="c1"># @param environ - shell environment variables dictionary that replaces the one inherited from the</span>

<span class="c1">#                  current process.</span>

<span class="c1">#</span>

<span class="c1"># @return returncode of called cmd</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">RunPythonScript</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">outstream</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>

                    <span class="n">environ</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

    <span class="c1"># locate python file on path</span>

    <span class="n">pythonfile</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">pythonfile</span><span class="p">:</span>

        <span class="n">pythonfile</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">pythonfile</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">params</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;RunPythonScript: {0} {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>

    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">)):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was given as absolute path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

    <span class="k">elif</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">pythonfile</span><span class="p">))):</span>

        <span class="n">pythonfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">pythonfile</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was given as relative path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># loop thru path environment variable</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PATH&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">):</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pythonfile</span><span class="p">)):</span>

                <span class="n">pythonfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pythonfile</span><span class="p">)</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was found on the path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

                <span class="k">break</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pythonfile</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">params</span>

    <span class="k">return</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="n">capture</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="n">workingdir</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span>

                  <span class="n">outstream</span><span class="o">=</span><span class="n">outstream</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="n">environ</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>

                  <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="n">raise_exception_on_nonzero</span><span class="p">)</span>

<span class="c1">####</span>

<span class="c1"># Locally Sign input file using Windows SDK signtool.  This will use a local Pfx file.</span>

<span class="c1"># WARNING!!! : This should not be used for production signing as that process should follow stronger</span>

<span class="c1">#               security practices (HSM / smart cards / etc)</span>

<span class="c1">#</span>

<span class="c1">#  Signing is in format specified by UEFI authentacted variables</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">DetachedSignWithSignTool</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">ToSignFilePath</span><span class="p">,</span> <span class="n">SignatureOutputFile</span><span class="p">,</span> <span class="n">PfxFilePath</span><span class="p">,</span>

                             <span class="n">PfxPass</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Oid</span><span class="o">=</span><span class="s2">&quot;1.2.840.113549.1.7.2&quot;</span><span class="p">,</span> <span class="n">Eku</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="c1"># check signtool path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Path to signtool invalid.  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SignToolPath</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># Adjust for spaces in the path (when calling the command).</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">SignToolPath</span><span class="p">:</span>

        <span class="n">SignToolPath</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">SignToolPath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">OutputDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">SignatureOutputFile</span><span class="p">)</span>

    <span class="c1"># Signtool docs https://docs.microsoft.com/en-us/dotnet/framework/tools/signtool-exe</span>

    <span class="c1"># Signtool parameters from</span>

    <span class="c1">#   https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/secure-boot-key-generation-and-signing-using-hsm--example  # noqa: E501</span>

    <span class="c1"># Search for &quot;Secure Boot Key Generation and Signing Using HSM&quot;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;sign /fd sha256 /p7ce DetachedSignedData /p7co &#39;</span> <span class="o">+</span> <span class="n">Oid</span> <span class="o">+</span> <span class="s1">&#39; /p7 &quot;&#39;</span> <span class="o">+</span> \

             <span class="n">OutputDir</span> <span class="o">+</span> <span class="s1">&#39;&quot; /f &quot;&#39;</span> <span class="o">+</span> <span class="n">PfxFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="k">if</span> <span class="n">Eku</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

        <span class="n">params</span> <span class="o">+=</span> <span class="s1">&#39; /u &#39;</span> <span class="o">+</span> <span class="n">Eku</span>

    <span class="k">if</span> <span class="n">PfxPass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

        <span class="c1"># add password if set</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /p &#39;</span> <span class="o">+</span> <span class="n">PfxPass</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /debug /v &quot;&#39;</span> <span class="o">+</span> <span class="n">ToSignFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Signtool failed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ret</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">signedfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OutputDir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">ToSignFilePath</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.p7&quot;</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">signedfile</span><span class="p">)):</span>

        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Output file doesn&#39;t exist </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">signedfile</span><span class="p">)</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">signedfile</span><span class="p">,</span> <span class="n">SignatureOutputFile</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ret</span>

<span class="c1">####</span>

<span class="c1"># Locally Sign input file using Windows SDK signtool.  This will use a local Pfx file.</span>

<span class="c1"># WARNING!!! : This should not be used for production signing as that process should follow</span>

<span class="c1">#              stronger security practices (HSM / smart cards / etc)</span>

<span class="c1">#</span>

<span class="c1">#  Signing is catalog format which is an attached signature</span>

<span class="c1">####</span>

<span class="k">def</span> <span class="nf">CatalogSignWithSignTool</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">ToSignFilePath</span><span class="p">,</span> <span class="n">PfxFilePath</span><span class="p">,</span> <span class="n">PfxPass</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="c1"># check signtool path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Path to signtool invalid.  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SignToolPath</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># Adjust for spaces in the path (when calling the command).</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">SignToolPath</span><span class="p">:</span>

        <span class="n">SignToolPath</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">SignToolPath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">OutputDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">ToSignFilePath</span><span class="p">)</span>

    <span class="c1"># Signtool docs https://docs.microsoft.com/en-us/dotnet/framework/tools/signtool-exe</span>

    <span class="c1"># todo: link to catalog signing documentation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="s2">&quot;sign /a /fd SHA256 /f &quot;</span> <span class="o">+</span> <span class="n">PfxFilePath</span>

    <span class="k">if</span> <span class="n">PfxPass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

        <span class="c1"># add password if set</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /p &#39;</span> <span class="o">+</span> <span class="n">PfxPass</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /debug /v &quot;&#39;</span> <span class="o">+</span> <span class="n">ToSignFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="n">OutputDir</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Signtool failed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ret</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ret</span>

<span class="c1">###</span>

<span class="c1"># Function to print a byte list as hex and optionally output ascii as well as</span>

<span class="c1"># offset within the buffer</span>

<span class="c1">###</span>

<span class="k">def</span> <span class="nf">PrintByteList</span><span class="p">(</span><span class="n">ByteList</span><span class="p">,</span> <span class="n">IncludeAscii</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">IncludeOffset</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">IncludeHexSep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">OffsetStart</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

    <span class="n">Ascii</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ByteList</span><span class="p">)):</span>

        <span class="c1"># Start of New Line</span>

        <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>

            <span class="k">if</span><span class="p">(</span><span class="n">IncludeOffset</span><span class="p">):</span>

                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;0x</span><span class="si">%04X</span><span class="s2"> -&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">OffsetStart</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># Midpoint of a Line</span>

        <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">8</span><span class="p">):</span>

            <span class="k">if</span><span class="p">(</span><span class="n">IncludeHexSep</span><span class="p">):</span>

                <span class="k">print</span><span class="p">(</span><span class="s2">&quot; -&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># Print As Hex Byte</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot; 0x</span><span class="si">%02X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ByteList</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># Prepare to Print As Ascii</span>

        <span class="k">if</span><span class="p">(</span><span class="n">ByteList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mh">0x20</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ByteList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mh">0x7E</span><span class="p">):</span>

            <span class="n">Ascii</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">Ascii</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ByteList</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

        <span class="c1"># End of Line</span>

        <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">15</span><span class="p">):</span>

            <span class="k">if</span><span class="p">(</span><span class="n">IncludeAscii</span><span class="p">):</span>

                <span class="k">print</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Ascii</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="n">Ascii</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># Done - Lets check if we have partial</span>

    <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">):</span>

        <span class="c1"># Lets print any partial line of ascii</span>

        <span class="k">if</span><span class="p">(</span><span class="n">IncludeAscii</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Ascii</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>

            <span class="c1"># Pad out to the correct spot</span>

            <span class="k">while</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">15</span><span class="p">):</span>

                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;     &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">7</span><span class="p">):</span>  <span class="c1"># account for the - symbol in the hex dump</span>

                    <span class="k">if</span><span class="p">(</span><span class="n">IncludeOffset</span><span class="p">):</span>

                        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># print the ascii partial line</span>

            <span class="k">print</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Ascii</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="c1"># print a single newline so that next print will be on new line</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Simplified Comparison Function borrowed from StackOverflow...</span>

<span class="c1"># https://stackoverflow.com/questions/1714027/version-number-comparison</span>

<span class="c1"># With Python 3.0 help from:</span>

<span class="c1"># https://docs.python.org/3.0/whatsnew/3.0.html#ordering-comparisons</span>

<span class="k">def</span> <span class="nf">version_compare</span><span class="p">(</span><span class="n">version1</span><span class="p">,</span> <span class="n">version2</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\.0+)*$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>

    <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">version1</span><span class="p">),</span> <span class="n">normalize</span><span class="p">(</span><span class="n">version2</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_valid_version</span><span class="p">(</span><span class="n">version</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    Returns whether a version is valid it must be (number).(number).(and so on) or (number)</span>

<span class="sd">    There is no limit to the number of extra numbers you can have in a version string</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">version_reg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[0-9]+(\.[0-9]+)*$&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">version_reg</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">import_module_by_file_name</span><span class="p">(</span><span class="n">module_file_path</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39; Standard method of importing a Python file. Expecting absolute path. &#39;&#39;&#39;</span>

    <span class="n">module_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">module_file_path</span><span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_file_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Expected module file named {module_file_path}&quot;</span><span class="p">)</span>

    <span class="n">ImportedModule</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">ImportedModule</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ImportedModule</span>

<span class="k">def</span> <span class="nf">locate_class_in_module</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">DesiredClass</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    Given a module and a class, this function will return the subclass of DesiredClass found in Module.</span>

<span class="sd">    It gives preference to classes that are defined in the module itself.</span>

<span class="sd">    This means that if you have an import that subclasses DesiredClass, it will be picked unless</span>

<span class="sd">    there is a class defined in the module that subclasses DesiredClass.</span>

<span class="sd">    In this hypothetical class hierarchy, GrandChildClass would be picked</span>

<span class="sd">    --------------      ------------      -----------------</span>

<span class="sd">    |DesiredClass|  -&gt;  |ChildClass|  -&gt;  |GrandChildClass|</span>

<span class="sd">    --------------      ------------      -----------------</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">DesiredClassInstance</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># Pull out the contents of the module that was provided</span>

    <span class="n">module_contents</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Module</span><span class="p">)</span>

    <span class="c1"># Filter through the Module, we&#39;re only looking for classes.</span>

    <span class="n">classList</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">module_contents</span>

                 <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">obj</span><span class="p">))]</span>

    <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classList</span><span class="p">:</span>

        <span class="c1"># Classes that the module import show up in this list too so we need</span>

        <span class="c1"># to make sure it&#39;s an INSTANCE of DesiredClass, not DesiredClass itself!</span>

        <span class="c1"># if multiple instances are found in the same class hierarchy, pick the</span>

        <span class="c1"># most specific one. If multiple instances are found belonging to different</span>

        <span class="c1"># class hierarchies, raise an error.</span>

        <span class="k">if</span> <span class="n">_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">DesiredClass</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_class</span><span class="p">,</span> <span class="n">DesiredClass</span><span class="p">):</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">DesiredClassInstance</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_class</span><span class="p">,</span> <span class="n">DesiredClassInstance</span><span class="p">):</span>

                <span class="n">DesiredClassInstance</span> <span class="o">=</span> <span class="n">_class</span>

            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">DesiredClassInstance</span><span class="p">,</span> <span class="n">_class</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Multiple instances were found:</span><span class="se">\n\t</span><span class="s2">{DesiredClassInstance}</span><span class="se">\n\t</span><span class="s2">{_class}&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">DesiredClassInstance</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="k">pass</span>

    <span class="c1"># Test code for printing a byte buffer</span>

    <span class="c1"># a = [0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3b, 0x3c, 0x3d]</span>

    <span class="c1"># index = 0x55</span>

    <span class="c1"># while(index &lt; 0x65):</span>

    <span class="c1">#     a.append(index)</span>

    <span class="c1">#     PrintByteList(a)</span>

    <span class="c1">#     index += 1</span>
</code></pre></div>

</details>
<h2 id="functions">Functions</h2>
<h4 id="catalogsignwithsigntool">CatalogSignWithSignTool</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">CatalogSignWithSignTool</span><span class="p">(</span>
    <span class="n">SignToolPath</span><span class="p">,</span>
    <span class="n">ToSignFilePath</span><span class="p">,</span>
    <span class="n">PfxFilePath</span><span class="p">,</span>
    <span class="n">PfxPass</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">CatalogSignWithSignTool</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">ToSignFilePath</span><span class="p">,</span> <span class="n">PfxFilePath</span><span class="p">,</span> <span class="n">PfxPass</span><span class="o">=</span><span class="n">None</span><span class="p">):</span>

    <span class="c1"># check signtool path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Path to signtool invalid.  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SignToolPath</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># Adjust for spaces in the path (when calling the command).</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">SignToolPath</span><span class="p">:</span>

        <span class="n">SignToolPath</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">SignToolPath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">OutputDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">ToSignFilePath</span><span class="p">)</span>

    <span class="c1"># Signtool docs https://docs.microsoft.com/en-us/dotnet/framework/tools/signtool-exe</span>

    <span class="c1"># todo: link to catalog signing documentation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="s2">&quot;sign /a /fd SHA256 /f &quot;</span> <span class="o">+</span> <span class="n">PfxFilePath</span>

    <span class="k">if</span> <span class="n">PfxPass</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">None</span><span class="p">:</span>

        <span class="c1"># add password if set</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /p &#39;</span> <span class="o">+</span> <span class="n">PfxPass</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /debug /v &quot;&#39;</span> <span class="o">+</span> <span class="n">ToSignFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="n">OutputDir</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Signtool failed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ret</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div>

</details>
<h4 id="detachedsignwithsigntool">DetachedSignWithSignTool</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">DetachedSignWithSignTool</span><span class="p">(</span>
    <span class="n">SignToolPath</span><span class="p">,</span>
    <span class="n">ToSignFilePath</span><span class="p">,</span>
    <span class="n">SignatureOutputFile</span><span class="p">,</span>
    <span class="n">PfxFilePath</span><span class="p">,</span>
    <span class="n">PfxPass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">Oid</span><span class="o">=</span><span class="s1">&#39;1.2.840.113549.1.7.2&#39;</span><span class="p">,</span>
    <span class="n">Eku</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">DetachedSignWithSignTool</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">ToSignFilePath</span><span class="p">,</span> <span class="n">SignatureOutputFile</span><span class="p">,</span> <span class="n">PfxFilePath</span><span class="p">,</span>

                             <span class="n">PfxPass</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">Oid</span><span class="o">=</span><span class="s2">&quot;1.2.840.113549.1.7.2&quot;</span><span class="p">,</span> <span class="n">Eku</span><span class="o">=</span><span class="n">None</span><span class="p">):</span>

    <span class="c1"># check signtool path</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Path to signtool invalid.  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SignToolPath</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># Adjust for spaces in the path (when calling the command).</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">SignToolPath</span><span class="p">:</span>

        <span class="n">SignToolPath</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">SignToolPath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">OutputDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">SignatureOutputFile</span><span class="p">)</span>

    <span class="c1"># Signtool docs https://docs.microsoft.com/en-us/dotnet/framework/tools/signtool-exe</span>

    <span class="c1"># Signtool parameters from</span>

    <span class="c1">#   https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/secure-boot-key-generation-and-signing-using-hsm--example  # noqa: E501</span>

    <span class="c1"># Search for &quot;Secure Boot Key Generation and Signing Using HSM&quot;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;sign /fd sha256 /p7ce DetachedSignedData /p7co &#39;</span> <span class="o">+</span> <span class="n">Oid</span> <span class="o">+</span> <span class="s1">&#39; /p7 &quot;&#39;</span> <span class="o">+</span> \

             <span class="n">OutputDir</span> <span class="o">+</span> <span class="s1">&#39;&quot; /f &quot;&#39;</span> <span class="o">+</span> <span class="n">PfxFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="k">if</span> <span class="n">Eku</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">None</span><span class="p">:</span>

        <span class="n">params</span> <span class="o">+=</span> <span class="s1">&#39; /u &#39;</span> <span class="o">+</span> <span class="n">Eku</span>

    <span class="k">if</span> <span class="n">PfxPass</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">None</span><span class="p">:</span>

        <span class="c1"># add password if set</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /p &#39;</span> <span class="o">+</span> <span class="n">PfxPass</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39; /debug /v &quot;&#39;</span> <span class="o">+</span> <span class="n">ToSignFilePath</span> <span class="o">+</span> <span class="s1">&#39;&quot; &#39;</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">SignToolPath</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Signtool failed </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ret</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="n">signedfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OutputDir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">ToSignFilePath</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.p7&quot;</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">signedfile</span><span class="p">)):</span>

        <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="s2">&quot;Output file doesn&#39;t exist </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">signedfile</span><span class="p">)</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">signedfile</span><span class="p">,</span> <span class="n">SignatureOutputFile</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div>

</details>
<h4 id="enum">Enum</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">Enum</span><span class="p">(</span>
    <span class="o">*</span><span class="n">args</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">Enum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">item</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">list</span><span class="p">):</span>

            <span class="n">items</span> <span class="o">=</span> <span class="n">item</span>

        <span class="k">elif</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">tuple</span><span class="p">):</span>

            <span class="n">items</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">args</span>

    <span class="n">calling_frame</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">calling_mod</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">calling_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">calling_func</span> <span class="o">=</span> <span class="n">calling_frame</span><span class="o">.</span><span class="n">function</span>

    <span class="n">calling_line</span> <span class="o">=</span> <span class="n">calling_frame</span><span class="o">.</span><span class="n">lineno</span>

    <span class="n">enum_name</span> <span class="o">=</span> <span class="n">calling_func</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">calling_line</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Enum is deprecated! Please fix it in {calling_mod}:{calling_func}&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">StdEnum</span><span class="p">(</span><span class="n">enum_name</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="n">calling_mod</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="gethostinfo">GetHostInfo</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">GetHostInfo</span><span class="p">(</span>

<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">GetHostInfo</span><span class="p">():</span>

    <span class="k">Host</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="s1">&#39;os arch bit&#39;</span><span class="p">)</span>

    <span class="n">host_info</span> <span class="o">=</span> <span class="n">platform</span><span class="p">.</span><span class="n">uname</span><span class="p">()</span>

    <span class="n">os</span> <span class="o">=</span> <span class="n">host_info</span><span class="p">.</span><span class="k">system</span>

    <span class="n">processor_info</span> <span class="o">=</span> <span class="n">host_info</span><span class="p">.</span><span class="n">machine</span>

    <span class="n">arch</span> <span class="o">=</span> <span class="k">None</span>

    <span class="nb">bit</span> <span class="o">=</span> <span class="k">None</span>

    <span class="k">if</span> <span class="p">(</span><span class="ss">&quot;x86&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">.</span><span class="k">lower</span><span class="p">())</span> <span class="k">or</span> <span class="p">(</span><span class="ss">&quot;AMD&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">.</span><span class="k">upper</span><span class="p">())</span> <span class="k">or</span> <span class="p">(</span><span class="ss">&quot;INTEL&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">.</span><span class="k">upper</span><span class="p">()):</span>

        <span class="n">arch</span> <span class="o">=</span> <span class="ss">&quot;x86&quot;</span>

    <span class="n">elif</span> <span class="p">(</span><span class="ss">&quot;ARM&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">.</span><span class="k">upper</span><span class="p">())</span> <span class="k">or</span> <span class="p">(</span><span class="ss">&quot;AARCH&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">.</span><span class="k">upper</span><span class="p">()):</span>

        <span class="n">arch</span> <span class="o">=</span> <span class="ss">&quot;ARM&quot;</span>

    <span class="k">if</span> <span class="ss">&quot;32&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">:</span>

        <span class="nb">bit</span> <span class="o">=</span> <span class="ss">&quot;32&quot;</span>

    <span class="n">elif</span> <span class="ss">&quot;64&quot;</span> <span class="k">in</span> <span class="n">processor_info</span><span class="p">:</span>

        <span class="nb">bit</span> <span class="o">=</span> <span class="ss">&quot;64&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">arch</span> <span class="k">is</span> <span class="k">None</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="nb">bit</span> <span class="k">is</span> <span class="k">None</span><span class="p">):</span>

        <span class="n">raise</span> <span class="n">EnvironmentError</span><span class="p">(</span><span class="ss">&quot;Host info could not be parsed: {0}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">host_info</span><span class="p">)))</span>

    <span class="k">return</span> <span class="k">Host</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="n">os</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">arch</span><span class="p">,</span> <span class="nb">bit</span><span class="o">=</span><span class="nb">bit</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="printbytelist">PrintByteList</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">PrintByteList</span><span class="p">(</span>
    <span class="n">ByteList</span><span class="p">,</span>
    <span class="n">IncludeAscii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">IncludeOffset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">IncludeHexSep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">OffsetStart</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">PrintByteList</span><span class="p">(</span><span class="n">ByteList</span><span class="p">,</span><span class="w"> </span><span class="n">IncludeAscii</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">IncludeOffset</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">IncludeHexSep</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">OffsetStart</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="nf">Ascii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">ByteList</span><span class="p">))</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Start</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Line</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">IncludeOffset</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;0x%04X -&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">OffsetStart</span><span class="p">),</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Midpoint</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Line</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">IncludeHexSep</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot; -&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Print</span><span class="w"> </span><span class="k">As</span><span class="w"> </span><span class="n">Hex</span><span class="w"> </span><span class="n">Byte</span><span class="w"></span>

<span class="w">        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot; 0x%02X&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">ByteList</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Prepare</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">Print</span><span class="w"> </span><span class="k">As</span><span class="w"> </span><span class="nf">Ascii</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">ByteList</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">0x20</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="p">(</span><span class="n">ByteList</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x7E</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">Ascii</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="ss">&quot;.&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">Ascii</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;%c&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">ByteList</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">End</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Line</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">IncludeAscii</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot; %s&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nf">Ascii</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">Ascii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="w"></span>

<span class="w">            </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Done</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Lets</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">partial</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Lets</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nf">ascii</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">IncludeAscii</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="nf">Ascii</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">Pad</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="n">spot</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;     &quot;</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hex</span><span class="w"> </span><span class="k">dump</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">IncludeOffset</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;  &quot;</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">index</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">ascii</span><span class="w"> </span><span class="k">partial</span><span class="w"> </span><span class="n">line</span><span class="w"></span>

<span class="w">            </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot; %s&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nf">Ascii</span><span class="p">,</span><span class="w"> </span><span class="k">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">newline</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">line</span><span class="w"></span>

<span class="w">        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;&quot;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="runcmd">RunCmd</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">RunCmd</span><span class="p">(</span>
    <span class="n">cmd</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">,</span>
    <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">workingdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">outstream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">environ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="k">parameters</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">outstream</span><span class="o">=</span><span class="k">None</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="k">None</span><span class="p">,</span>

           <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="k">False</span><span class="p">):</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;\&#39;&#39;)</span>

<span class="s1">    if &quot; &quot; in cmd:</span>

<span class="s1">        cmd = &#39;</span><span class="ss">&quot;&#39; + cmd + &#39;&quot;</span><span class="err">&#39;</span>

    <span class="k">if</span> <span class="k">parameters</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span><span class="p">:</span>

        <span class="k">parameters</span> <span class="o">=</span> <span class="k">parameters</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">cmd</span> <span class="o">+=</span> <span class="ss">&quot; &quot;</span> <span class="o">+</span> <span class="k">parameters</span>

    <span class="n">starttime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;Cmd to run is: &quot;</span> <span class="o">+</span> <span class="n">cmd</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;--------------Cmd Output Starting---------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="k">c</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="k">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="k">STDOUT</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">workingdir</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="k">True</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">environ</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">capture</span><span class="p">):</span>

        <span class="n">thread</span> <span class="o">=</span> <span class="n">PropagatingThread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">outstream</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="k">stdout</span><span class="p">,</span> <span class="n">logging_level</span><span class="p">))</span>

        <span class="n">thread</span><span class="p">.</span><span class="k">start</span><span class="p">()</span>

        <span class="k">c</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="n">thread</span><span class="p">.</span><span class="k">join</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">c</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="n">endtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span>

    <span class="n">endtime_str</span> <span class="o">=</span> <span class="ss">&quot;{0[0]:02}:{0[1]:02}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">divmod</span><span class="p">(</span><span class="n">delta</span><span class="p">.</span><span class="n">seconds</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>

    <span class="n">returncode_str</span> <span class="o">=</span> <span class="ss">&quot;{0:#010x}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">returncode</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;--------------Cmd Output Finished---------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;--------- Running Time (mm:ss): &quot;</span> <span class="o">+</span> <span class="n">endtime_str</span> <span class="o">+</span> <span class="ss">&quot; ----------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;----------- Return Code: &quot;</span> <span class="o">+</span> <span class="n">returncode_str</span> <span class="o">+</span> <span class="ss">&quot; ------------&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="ss">&quot;------------------------------------------------&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">raise_exception_on_nonzero</span> <span class="k">and</span> <span class="k">c</span><span class="p">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">raise</span> <span class="k">Exception</span><span class="p">(</span><span class="ss">&quot;{0} failed with Return Code: {1}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">returncode_str</span><span class="p">))</span>

    <span class="k">return</span> <span class="k">c</span><span class="p">.</span><span class="n">returncode</span>
</code></pre></div>

</details>
<h4 id="runpythonscript">RunPythonScript</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">RunPythonScript</span><span class="p">(</span>
    <span class="n">pythonfile</span><span class="p">,</span>
    <span class="n">params</span><span class="p">,</span>
    <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">workingdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">outstream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">environ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">RunPythonScript</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="n">True</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">outstream</span><span class="o">=</span><span class="n">None</span><span class="p">,</span>

                    <span class="n">environ</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="n">False</span><span class="p">):</span>

    <span class="c1"># locate python file on path</span>

    <span class="n">pythonfile</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">pythonfile</span><span class="p">:</span>

        <span class="n">pythonfile</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">pythonfile</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>

    <span class="n">params</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;RunPythonScript: {0} {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">,</span> <span class="n">params</span><span class="p">))</span>

    <span class="k">if</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">pythonfile</span><span class="p">)):</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was given as absolute path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

    <span class="k">elif</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">pythonfile</span><span class="p">))):</span>

        <span class="n">pythonfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">pythonfile</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was given as relative path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># loop thru path environment variable</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PATH&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">):</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pythonfile</span><span class="p">)):</span>

                <span class="n">pythonfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pythonfile</span><span class="p">)</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Python Script was found on the path: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pythonfile</span><span class="p">)</span>

                <span class="k">break</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pythonfile</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">params</span>

    <span class="k">return</span> <span class="n">RunCmd</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="n">capture</span><span class="p">,</span> <span class="n">workingdir</span><span class="o">=</span><span class="n">workingdir</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span>

                  <span class="n">outstream</span><span class="o">=</span><span class="n">outstream</span><span class="p">,</span> <span class="n">environ</span><span class="o">=</span><span class="n">environ</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>

                  <span class="n">raise_exception_on_nonzero</span><span class="o">=</span><span class="n">raise_exception_on_nonzero</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="import_module_by_file_name">import_module_by_file_name</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">import_module_by_file_name</span><span class="p">(</span>
    <span class="n">module_file_path</span>
<span class="p">)</span>
</code></pre></div>

<p>Standard method of importing a Python file. Expecting absolute path. </p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">import_module_by_file_name</span><span class="p">(</span><span class="n">module_file_path</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39; Standard method of importing a Python file. Expecting absolute path. &#39;&#39;&#39;</span>

    <span class="n">module_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">module_file_path</span><span class="p">)</span>

    <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_file_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">spec</span> <span class="k">is</span> <span class="n">None</span><span class="p">:</span>

        <span class="n">raise</span> <span class="n">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Expected module file named {module_file_path}&quot;</span><span class="p">)</span>

    <span class="n">ImportedModule</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

    <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">ImportedModule</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ImportedModule</span>
</code></pre></div>

</details>
<h4 id="is_valid_version">is_valid_version</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_version</span><span class="p">(</span>
    <span class="n">version</span>
<span class="p">)</span>
</code></pre></div>

<p>Returns whether a version is valid it must be (number).(number).(and so on) or (number) 
There is no limit to the number of extra numbers you can have in a version string</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">is_valid_version</span><span class="p">(</span><span class="k">version</span><span class="p">):</span>

    <span class="s1">&#39;&#39;&#39;</span>

<span class="s1">    Returns whether a version is valid it must be (number).(number).(and so on) or (number)</span>

<span class="s1">    There is no limit to the number of extra numbers you can have in a version string</span>

<span class="s1">    &#39;&#39;&#39;</span>

    <span class="n">version_reg</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">compile</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;^[0-9]+(\.[0-9]+)*$&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">version_reg</span><span class="p">.</span><span class="k">match</span><span class="p">(</span><span class="k">version</span><span class="p">)</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span>
</code></pre></div>

</details>
<h4 id="locate_class_in_module">locate_class_in_module</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">locate_class_in_module</span><span class="p">(</span>
    <span class="n">Module</span><span class="p">,</span>
    <span class="n">DesiredClass</span>
<span class="p">)</span>
</code></pre></div>

<p>Given a module and a class, this function will return the subclass of DesiredClass found in Module.
It gives preference to classes that are defined in the module itself.
This means that if you have an import that subclasses DesiredClass, it will be picked unless
there is a class defined in the module that subclasses DesiredClass.</p>
<p>In this hypothetical class hierarchy, GrandChildClass would be picked
--------------      ------------      -----------------
|DesiredClass|  -&gt;  |ChildClass|  -&gt;  |GrandChildClass|
--------------      ------------      -----------------</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">locate_class_in_module</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">DesiredClass</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    Given a module and a class, this function will return the subclass of DesiredClass found in Module.</span>

<span class="sd">    It gives preference to classes that are defined in the module itself.</span>

<span class="sd">    This means that if you have an import that subclasses DesiredClass, it will be picked unless</span>

<span class="sd">    there is a class defined in the module that subclasses DesiredClass.</span>

<span class="sd">    In this hypothetical class hierarchy, GrandChildClass would be picked</span>

<span class="sd">    --------------      ------------      -----------------</span>

<span class="sd">    |DesiredClass|  -&gt;  |ChildClass|  -&gt;  |GrandChildClass|</span>

<span class="sd">    --------------      ------------      -----------------</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">DesiredClassInstance</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># Pull out the contents of the module that was provided</span>

    <span class="n">module_contents</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">Module</span><span class="p">)</span>

    <span class="c1"># Filter through the Module, we&#39;re only looking for classes.</span>

    <span class="n">classList</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">module_contents</span>

                 <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">Module</span><span class="p">,</span> <span class="n">obj</span><span class="p">))]</span>

    <span class="k">for</span> <span class="n">_class</span> <span class="ow">in</span> <span class="n">classList</span><span class="p">:</span>

        <span class="c1"># Classes that the module import show up in this list too so we need</span>

        <span class="c1"># to make sure it&#39;s an INSTANCE of DesiredClass, not DesiredClass itself!</span>

        <span class="c1"># if multiple instances are found in the same class hierarchy, pick the</span>

        <span class="c1"># most specific one. If multiple instances are found belonging to different</span>

        <span class="c1"># class hierarchies, raise an error.</span>

        <span class="k">if</span> <span class="n">_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">DesiredClass</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_class</span><span class="p">,</span> <span class="n">DesiredClass</span><span class="p">):</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">DesiredClassInstance</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_class</span><span class="p">,</span> <span class="n">DesiredClassInstance</span><span class="p">):</span>

                <span class="n">DesiredClassInstance</span> <span class="o">=</span> <span class="n">_class</span>

            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">DesiredClassInstance</span><span class="p">,</span> <span class="n">_class</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Multiple instances were found:</span><span class="se">\n\t</span><span class="s2">{DesiredClassInstance}</span><span class="se">\n\t</span><span class="s2">{_class}&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">DesiredClassInstance</span>
</code></pre></div>

</details>
<h4 id="reader">reader</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">reader</span><span class="p">(</span>
    <span class="n">filepath</span><span class="p">,</span>
    <span class="n">outstream</span><span class="p">,</span>
    <span class="n">stream</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">reader</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">outstream</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">):</span>

    <span class="n">f</span> <span class="o">=</span> <span class="k">None</span>

    <span class="o">#</span> <span class="k">open</span> <span class="n">file</span> <span class="k">if</span> <span class="n">caller</span> <span class="n">provided</span> <span class="n">path</span>

    <span class="k">if</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>

        <span class="n">f</span> <span class="o">=</span> <span class="k">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="ss">&quot;w&quot;</span><span class="p">)</span>

    <span class="n">while</span> <span class="k">True</span><span class="p">:</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">stream</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">decode</span><span class="p">()</span>

        <span class="k">if</span> <span class="k">not</span> <span class="n">s</span><span class="p">:</span>

            <span class="n">break</span>

        <span class="k">if</span><span class="p">(</span><span class="n">f</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span><span class="p">):</span>

            <span class="o">#</span> <span class="k">write</span> <span class="k">to</span> <span class="n">file</span> <span class="k">if</span> <span class="n">caller</span> <span class="n">provided</span> <span class="n">file</span>

            <span class="n">f</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">outstream</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span><span class="p">):</span>

            <span class="o">#</span> <span class="k">write</span> <span class="k">to</span> <span class="n">stream</span> <span class="k">object</span> <span class="k">if</span> <span class="n">caller</span> <span class="n">provided</span> <span class="k">object</span>

            <span class="n">outstream</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="n">logging</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging_level</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">rstrip</span><span class="p">())</span>

    <span class="n">stream</span><span class="p">.</span><span class="k">close</span><span class="p">()</span>

    <span class="k">if</span><span class="p">(</span><span class="n">f</span> <span class="k">is</span> <span class="k">not</span> <span class="k">None</span><span class="p">):</span>

        <span class="n">f</span><span class="p">.</span><span class="k">close</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="timing">timing</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">timing</span><span class="p">(</span>
    <span class="n">f</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">timing</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>

    <span class="n">def</span> <span class="n">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="n">time1</span> <span class="o">=</span> <span class="k">time</span><span class="p">.</span><span class="k">time</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="n">time2</span> <span class="o">=</span> <span class="k">time</span><span class="p">.</span><span class="k">time</span><span class="p">()</span>

        <span class="n">logging</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;{:s} function took {:.3f} ms&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span> <span class="p">(</span><span class="n">time2</span> <span class="o">-</span> <span class="n">time1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">return</span> <span class="n">wrap</span>
</code></pre></div>

</details>
<h4 id="version_compare">version_compare</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">version_compare</span><span class="p">(</span>
    <span class="n">version1</span><span class="p">,</span>
    <span class="n">version2</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">version_compare</span><span class="p">(</span><span class="n">version1</span><span class="p">,</span> <span class="n">version2</span><span class="p">):</span>

    <span class="n">def</span> <span class="n">normalize</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;(\.0+)*$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="ss">&quot;.&quot;</span><span class="p">)]</span>

    <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">version1</span><span class="p">),</span> <span class="n">normalize</span><span class="p">(</span><span class="n">version2</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="propagatingthread">PropagatingThread</h3>
<div class="python3 codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PropagatingThread</span><span class="p">(</span>
    <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
    <span class="n">kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">daemon</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>A class that represents a thread of control.</p>
<p>This class can be safely subclassed in a limited fashion. There are two ways
to specify the activity: by passing a callable object to the constructor, or
by overriding the run() method in a subclass.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">PropagatingThread</span>(<span class="n">threading</span>.<span class="nb">Thread</span>):

    <span class="n">def</span> <span class="nb">run</span>(<span class="nb">self</span>):

        <span class="nb">self</span>.<span class="n">exc</span> = <span class="n">None</span>

        <span class="n">try:</span>

            <span class="k">if</span> <span class="n">hasattr</span>(<span class="nb">self</span>, <span class="s">&#39;_Thread__target&#39;</span>):

                <span class="c1"># Thread uses name mangling prior to Python 3.</span>

                <span class="nb">self</span>.<span class="n">ret</span> = <span class="nb">self</span>.<span class="n">_Thread__target</span>(*<span class="nb">self</span>.<span class="n">_Thread__args</span>, **<span class="nb">self</span>.<span class="n">_Thread__kwargs</span>)

            <span class="n">else:</span>

                <span class="nb">self</span>.<span class="n">ret</span> = <span class="nb">self</span>.<span class="n">_target</span>(*<span class="nb">self</span>.<span class="n">_args</span>, **<span class="nb">self</span>.<span class="n">_kwargs</span>)

        <span class="n">except</span> <span class="n">BaseException</span> <span class="n">as</span> <span class="n">e:</span>

            <span class="nb">self</span>.<span class="n">exc</span> = <span class="nb">e</span>

    <span class="n">def</span> <span class="nb">join</span>(<span class="nb">self</span>, <span class="n">timeout</span>=<span class="n">None</span>):

        <span class="n">super</span>(<span class="n">PropagatingThread</span>, <span class="nb">self</span>).<span class="nb">join</span>()

        <span class="k">if</span> <span class="nb">self</span>.<span class="n">exc:</span>

            <span class="n">raise</span> <span class="nb">self</span>.<span class="n">exc</span>

        <span class="k">return</span> <span class="nb">self</span>.<span class="n">ret</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>threading.Thread</li>
</ul>
<h4 id="instance-variables">Instance variables</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="n">daemon</span>
</code></pre></div>

<p>A boolean value indicating whether this thread is a daemon thread.</p>
<p>This must be set before start() is called, otherwise RuntimeError is
raised. Its initial value is inherited from the creating thread; the
main thread is not a daemon thread and therefore all threads created in
the main thread default to daemon = False.</p>
<p>The entire Python program exits when only daemon threads are left.</p>
<div class="python3 codehilite"><pre><span></span><code><span class="n">ident</span>
</code></pre></div>

<p>Thread identifier of this thread or None if it has not been started.</p>
<p>This is a nonzero integer. See the get_ident() function. Thread
identifiers may be recycled when a thread exits and another thread is
created. The identifier is available even after the thread has exited.</p>
<div class="python3 codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>

<p>A string used for identification purposes only.</p>
<p>It has no semantics. Multiple threads may be given the same name. The
initial name is set by the constructor.</p>
<div class="python3 codehilite"><pre><span></span><code><span class="n">native_id</span>
</code></pre></div>

<p>Native integral thread ID of this thread, or None if it has not been started.</p>
<p>This is a non-negative integer. See the get_native_id() function.
This represents the Thread ID as reported by the kernel.</p>
<h4 id="methods">Methods</h4>
<h4 id="getname">getName</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getName</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">getName</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">name</span>
</code></pre></div>

</details>
<h4 id="isalive">isAlive</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isAlive</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return whether the thread is alive.</p>
<p>This method is deprecated, use is_alive() instead.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="k">def</span> <span class="nf">isAlive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Return whether the thread is alive.</span>

<span class="sd">        This method is deprecated, use is_alive() instead.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">warnings</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;isAlive() is deprecated, use is_alive() instead&#39;</span><span class="p">,</span>

                      <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="isdaemon">isDaemon</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isDaemon</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">isDaemon</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">daemon</span>
</code></pre></div>

</details>
<h4 id="is_alive">is_alive</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return whether the thread is alive.</p>
<p>This method returns True just before the run() method starts until just
after the run() method terminates. The module function enumerate()
returns a list of all alive threads.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Return whether the thread is alive.</span>

<span class="sd">        This method returns True just before the run() method starts until just</span>

<span class="sd">        after the run() method terminates. The module function enumerate()</span>

<span class="sd">        returns a list of all alive threads.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">,</span> <span class="s2">&quot;Thread.__init__() not called&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>

            <span class="k">return</span> <span class="n">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_tstate_lock</span><span class="p">(</span><span class="n">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span>
</code></pre></div>

</details>
<h4 id="join">join</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Wait until the thread terminates.</p>
<p>This blocks the calling thread until the thread whose join() method is
called terminates &ndash; either normally or through an unhandled exception
or until the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof). As join() always returns None, you must call
is_alive() after join() to decide whether a timeout happened &ndash; if the
thread is still alive, the join() call timed out.</p>
<p>When the timeout argument is not present or None, the operation will
block until the thread terminates.</p>
<p>A thread can be join()ed many times.</p>
<p>join() raises a RuntimeError if an attempt is made to join the current
thread as that would cause a deadlock. It is also an error to join() a
thread before it has been started and attempts to do so raises the same
exception.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="k">join</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="k">None</span><span class="p">):</span>

        <span class="n">super</span><span class="p">(</span><span class="n">PropagatingThread</span><span class="p">,</span> <span class="k">self</span><span class="p">).</span><span class="k">join</span><span class="p">()</span>

        <span class="k">if</span> <span class="k">self</span><span class="p">.</span><span class="n">exc</span><span class="p">:</span>

            <span class="n">raise</span> <span class="k">self</span><span class="p">.</span><span class="n">exc</span>

        <span class="k">return</span> <span class="k">self</span><span class="p">.</span><span class="n">ret</span>
</code></pre></div>

</details>
<h4 id="run">run</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Method representing the thread&rsquo;s activity.</p>
<p>You may override this method in a subclass. The standard run() method
invokes the callable object passed to the object&rsquo;s constructor as the
target argument, if any, with sequential and keyword arguments taken
from the args and kwargs arguments, respectively.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">run</span><span class="p">(</span><span class="k">self</span><span class="p">):</span>

        <span class="k">self</span><span class="p">.</span><span class="n">exc</span> <span class="o">=</span> <span class="k">None</span>

        <span class="n">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">hasattr</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="s1">&#39;_Thread__target&#39;</span><span class="p">):</span>

                <span class="o">#</span> <span class="n">Thread</span> <span class="n">uses</span> <span class="n">name</span> <span class="n">mangling</span> <span class="k">prior</span> <span class="k">to</span> <span class="n">Python</span> <span class="mi">3</span><span class="p">.</span>

                <span class="k">self</span><span class="p">.</span><span class="n">ret</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">_Thread__target</span><span class="p">(</span><span class="o">*</span><span class="k">self</span><span class="p">.</span><span class="n">_Thread__args</span><span class="p">,</span> <span class="o">**</span><span class="k">self</span><span class="p">.</span><span class="n">_Thread__kwargs</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">self</span><span class="p">.</span><span class="n">ret</span> <span class="o">=</span> <span class="k">self</span><span class="p">.</span><span class="n">_target</span><span class="p">(</span><span class="o">*</span><span class="k">self</span><span class="p">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="k">self</span><span class="p">.</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="k">self</span><span class="p">.</span><span class="n">exc</span> <span class="o">=</span> <span class="n">e</span>
</code></pre></div>

</details>
<h4 id="setdaemon">setDaemon</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setDaemon</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">daemonic</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">setDaemon</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">daemonic</span><span class="p">):</span>

        <span class="k">self</span><span class="p">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="n">daemonic</span>
</code></pre></div>

</details>
<h4 id="setname">setName</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setName</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="n">def</span> <span class="n">setName</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="k">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</code></pre></div>

</details>
<h4 id="start">start</h4>
<div class="python3 codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Start the thread&rsquo;s activity.</p>
<p>It must be called at most once per thread object. It arranges for the
object&rsquo;s run() method to be invoked in a separate thread of control.</p>
<p>This method will raise a RuntimeError if called more than once on the
same thread object.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">start</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Start the thread&#39;s activity.</span>

<span class="ss">        It must be called at most once per thread object. It arranges for the</span>

<span class="ss">        object&#39;s run() method to be invoked in a separate thread of control.</span>

<span class="ss">        This method will raise a RuntimeError if called more than once on the</span>

<span class="ss">        same thread object.</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_initialized</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="ss">&quot;thread.__init__() not called&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_started</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="ss">&quot;threads can only be started once&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="nl">_active_limbo_lock</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_limbo</span><span class="o">[</span><span class="n">self</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_start_new_thread</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_bootstrap</span><span class="p">,</span><span class="w"> </span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="nl">_active_limbo_lock</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">del</span><span class="w"> </span><span class="n">_limbo</span><span class="o">[</span><span class="n">self</span><span class="o">]</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_started</span><span class="p">.</span><span class="n">wait</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../gitignore_parser/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Gitignore parser
              </div>
            </div>
          </a>
        
        
          <a href="../acpi/dmar_parser/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Dmar parser
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright (c) Microsoft.  All rights reserved
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/version-select.js"></script>
      
    
  </body>
</html>